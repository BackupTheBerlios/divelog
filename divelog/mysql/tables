#!/bin/bash
# $Id: tables,v 1.10 2002/02/13 18:47:25 markus Exp $ 

mysql -h zaphod -u markus --password='ArPPCa' divelog-test <<EOF
drop table diver;
create table diver (
    number  INTEGER UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    first_name VARCHAR(20) NOT NULL,
    last_name VARCHAR(30),
    brevet VARCHAR(10),
    street VARCHAR(40),
    house_number VARCHAR(6),
    zip INTEGER,
    place VARCHAR(20),
    phone VARCHAR(20),
    email VARCHAR(130),
    UNIQUE( first_name, last_name, street, house_number, zip )
);

drop table divecomputer;
create table divecomputer(
    serial_number VARCHAR(16) PRIMARY KEY,
    diver_number INTEGER UNSIGNED NOT NULL REFERENCES diver,
    name VARCHAR(30) 
);

drop table divetype;
create table divetype (
    number  INTEGER UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    description VARCHAR(20),
    UNIQUE ( description )
);

drop table filling_station;
create table filling_station (
    number  INTEGER UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    stationname VARCHAR(20) NOT NULL,
    first_name  VARCHAR(20),
    last_name   VARCHAR(30),
    UNIQUE ( stationname )
);

drop table dive;
create table dive (
    number INTEGER UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    date DATETIME NOT NULL,
    sync INTEGER,
    diver_number INTEGER UNSIGNED NOT NULL REFERENCES diver,
    place VARCHAR(100) NOT NULL,
    location VARCHAR(100),
    altitude_mode DOUBLE NOT NULL,
    water_temperature DOUBLE NOT NULL,
    start_pressure DOUBLE NOT NULL,
    end_pressure DOUBLE NOT NULL,
    surface_intervall DOUBLE NOT NULL,
    max_depth DOUBLE NOT NULL,
    length TIME NOT NULL,
    profile BLOB, 
    log TEXT,
    partner_diver_number INTEGER NOT NULL REFERENCES diver,
    weather VARCHAR(20),
    sight   VARCHAR(20),
    lead  FLOAT,
    air_temperature DOUBLE,
    dive_type INTEGER REFERENCES divetype,
    filling_station_number INTEGER UNSIGNED NOT NULL REFERENCES filling_station,
    bottle_number INTEGER NOT NULL,    
    UNIQUE ( date, diver_number ),
    KEY ( date, diver_number )
);
EOF
    
    